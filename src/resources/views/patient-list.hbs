<div class='patient-list fadeInDown main-content'>
	<div class='container mt-3 white-background patient-list__container' style='@media (min-width: 992px) {min-width: 1140px;}'>
		<h1 class='patient-list__title'>DANH SÁCH BỆNH NHÂN</h1>
		<a class='add-patient' href='/benh-nhan/them'>Thêm bệnh nhân</a>
		<table class='table patient-list__table'>
			<thead>
				<tr>
					<th>STT</th>
					<th>MSBN</th>
					<th style='width: 235px;'>Tên bệnh nhân</th>
					<th style='width: 76px;'>Giới tính</th>
					{{! <th scope="col">Nghề nghiệp</th> }}
					<th>Số BHXH</th>
					<th style='width: 95px;'>Ngày sinh</th>
					{{! <th scope="col">Nơi sinh</th> }}
					<th style='width: 106px;'>Số điện thoại</th>
					<th>Địa chỉ</th>
					<th style='width: 93px;'>Nhóm máu</th>
					<th></th>
					<th></th>
				</tr>
			</thead>
			<tbody>
				{{#each patients}}
					<tr>
						<th>{{inc @index}}</th>
						<td>{{this.patient_id}}</td>
						<td>
							<a href='/tim-kiem?search={{this.patient_id}}'>{{this.first-name}} {{this.last-name}}</a>
						</td>
						<td>{{this.gender}}</td>
						<td>{{this.insurance-number}}</td>
						<td class='dob-field'>{{this.date-of-birth}}</td>
						<td>{{this.phone-number}}</td>
						<td>{{this.address}}, {{this.village}}, {{this.province}}, {{this.city}}</td>
						<td>{{this.blood-group}}</td>
						<td>
							<a href='/benh-nhan/{{this.patient_id}}/chinh-sua'>Sửa</a>
						</td>
						<td>
							<a
								href='/benh-nhan'
								id="delete-link"
								data-id='{{this.patient_id}}'
								data-toggle='modal'
								data-target='#confirm-delete'
							>Xóa</a>
						</td>
					</tr>
				{{/each}}
			</tbody>
		</table>
	</div>
</div>

		<form name="delete-patient-form" method="POST"></form>

<div id='confirm-delete' class='modal' tabindex='-1' role='dialog'>
	<div class='modal-dialog' role='document'>
		<div class='modal-content'>
			<div class='modal-header'>
				<h5 class='modal-title'>Xác nhận xóa</h5>
				<button type='button' class='close' data-dismiss='modal' aria-label='Close'>
					<span aria-hidden='true'>&times;</span>
				</button>
			</div>
			<div class='modal-body'>
				<p>Bạn có chắc muốn xóa bệnh nhân này?</p>
			</div>
			<div class='modal-footer'>
				<button id="delete-patient-btn" class='btn btn-danger'>Xóa</button>
				<button type='button' class='btn btn-secondary' data-dismiss='modal'>Hủy</button>
			</div>
		</div>
	</div>
</div>

<script>
	document.addEventListener('DOMContentLoaded', function() {
		var id
		var deleteForm = document.forms['delete-patient-form']
		var deletePatientBtn = document.getElementById('delete-patient-btn')

		$('#confirm-delete').on('show.bs.modal', function (event) { 
			var button = $(event.relatedTarget) 
			id = button.data('id') 
		})
		deletePatientBtn.onclick = function() {
			deleteForm.action = '/benh-nhan/' + id + '?_method=DELETE'
			deleteForm.submit()
		}
	})
</script>